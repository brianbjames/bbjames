<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Cymbalism</title>
<style type="text/css">
<!--
.style1 {font-family: Monaco}
-->
</style>
</head>

<body>
<p class="style1"><br />
  // cymbalism, by brian b. james, based on code from the examples in SC3</p>
<p class="style1">(<br />
  var w, f, d, values, server, id, isOn = false, b1, b2;</p>
<p class="style1">SynthDef(&quot;cymbalism&quot;, {<br />
  // cymbalism<br />
  var p, a, c, d, s, b, y, i, j, k;<br />
  var z, f1, f2;<br />
  p = 15;	// number of partials per channel per 'cymbal'.<br />
  f1 = 250;<br />
  f2 = 500;<br />
  z = Array.fill(2, {<br />
  `[	// sine oscil bank specification:<br />
  y = Array.fill(p, { f1 + f2.rand} ), // frequencies<br />
  nil, <br />
  Array.fill(p, { 1.0 + 4.0 })	// ring times<br />
  ]<br />
  });<br />
  a = Klank.ar(z, Decay.ar(Impulse.ar(0.00009 + 0.1), 0.004, WhiteNoise.ar(0.0003, 0.0005)));<br />
  Out.ar(0, a) <br />
  }).writeDefFile;<br />
  Server.local.sendMsg(&quot;/d_load&quot;, &quot;synthdefs/cymbalism.scsyndef&quot;);</p>
<p class="style1">values = IdentityDictionary.new;<br />
  server = Server.local;</p>
<p class="style1">id = 2001;<br />
  w = SCWindow(&quot;cymbalism&quot;, Rect(512, 164, 180, 80));<br />
  w.view.decorator = d = FlowLayout(w.view.bounds);</p>
<p class="style1">b1 = SCButton(w, Rect(0,0, 50, 50));<br />
  b1.states = [[&quot;Load&quot;, Color.black, Color.green]];<br />
  b1.action = { arg view; <br />
  server.sendMsg(&quot;/d_load&quot;, &quot;synthdefs/cymbalism.scsyndef&quot;);<br />
  };<br />
  b1.enabled = server.serverRunning;</p>
<p class="style1">b2 = SCButton(w, Rect(0,0, 100, 50));<br />
  b2.states = [<br />
  [&quot;cymbalism&quot;, Color.black, Color.green],<br />
  [&quot;cymbalism stop&quot;, Color.white, Color.red],<br />
  ];<br />
  b2.action = { arg view; <br />
  var msg;<br />
  if (view.value == 1, {<br />
  isOn = true;<br />
  msg = [&quot;/s_new&quot;, &quot;cymbalism&quot;, 2001, 1, 0];<br />
  values.keysValuesDo({ arg key, value; <br />
  msg = msg.addAll([key, value]); <br />
  });<br />
  server.performList(\sendMsg, msg); <br />
  },{<br />
  isOn = false;<br />
  server.sendMsg(&quot;/n_free&quot;, 2001); <br />
  });<br />
  };<br />
  b2.enabled = server.serverRunning;<br />
  d.nextLine;</p>
<p class="style1">a = SimpleController(server);<br />
  f = { arg server; <br />
  b1.enabled = server.serverRunning;<br />
  b2.enabled = server.serverRunning;<br />
  if (server.serverRunning.not, { b2.value = 0 });<br />
  };<br />
  a.put(\serverRunning, f);<br />
  w.onClose = { <br />
  if (isOn, { server.sendMsg(&quot;/n_free&quot;, 2001) });<br />
  a.remove;<br />
  };</p>
<p class="style1">w.front;<br />
  )</p>
</body>
</html>
